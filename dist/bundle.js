(()=>{"use strict";function e(e){return Caido.graphql.deleteAssistantSession({id:e})}const t=async t=>{const n=function(e){const t=e.split("\n");return t[0]+"\n"+t[1]+"\n\n"+(t.join("\n").split("\n\n")[1]||"")}(await async function(e){const t=(await Caido.graphql.replaySessionEntries({id:e.toString()})).replaySession.activeEntry;if(console.log(t),t){const e=t.request.id,n=(await Caido.graphql.request({id:e})).request;if(n)return n.raw}}(t)),s=n.split("\n\n")[1];if(!function(e){return e.includes("operationName")}(s))return await function(t,n){let s=null;return function(e,t){return Caido.graphql.createAssistantSession({input:{systemMessage:e,modelId:"gpt-3.5-turbo"}})}(t).then((e=>(s=e.createAssistantSession.session.id,function(e,t){return Caido.graphql.sendAssistantMessage({sessionId:e,message:t})}(s,n)))).then((()=>function(e){return new Promise(((t,n)=>{const s=setInterval((()=>{Caido.graphql.assistantSession({id:e}).then((e=>{if(e.assistantSession.messages.length>=3){const n=e.assistantSession.messages[2].content;clearInterval(s),t(n)}})).catch((e=>{clearInterval(s),n(e)}))}),1e3)}))}(s))).then((t=>e(s).then((()=>t)))).catch((t=>s?e(s).then((()=>Promise.reject(t))):Promise.reject(t)))}("Given the user's HTTP request, provide a short name for the request one-five words max. Be descriptive and specific.",n);{const e=function(e){const t=/"operationName"\s*:\s*"([^"]+)"/.exec(e);return t&&t[1]?t[1]:"BUG!! No operationName found"}(s);Caido.graphql.renameReplaySession({id:t,name:`GraphQL: ${e}`})}};EvenBetterAPI.eventManager.on("onContextMenuOpen",(e=>{"#/replay"===function(){let e=window.location.hash;return e.includes("?custom-path=")&&(e=e.split("?custom-path=")[1]),e}()&&function(e,t){const n=document.querySelector(".p-contextmenu-root-list"),s=document.createElement("li");s.id=`pv_id_1_${n.children.length}`,s.className="p-menuitem",s.setAttribute("role","menuitem"),s.setAttribute("aria-label",e),s.setAttribute("aria-level","1"),s.setAttribute("aria-setsize",n.children.length+1),s.setAttribute("aria-posinset",n.children.length),s.setAttribute("data-pc-section","menuitem"),s.setAttribute("data-p-highlight","false"),s.setAttribute("data-p-focused","false"),s.innerHTML=`\n        <div class="p-menuitem-content" data-pc-section="content">\n            <div data-v-25e37fb9 class="c-context-menu__item">\n                <div class="c-context-menu__content">${e}</div>\n                <div class="c-context-menu__trailing-visual"></div>\n            </div>\n        </div>\n    `,s.addEventListener("click",(function(){t(),function(){const e=document.querySelector(".p-contextmenu");e&&(e.style.display="none")}()})),n.appendChild(s)}("Generate Replay Name",(async()=>{(function(){const e=document.querySelectorAll('.c-tab[data-is-selected="true"]');return Array.from(e).map((e=>e.getAttribute("data-session-id")))})().map((async e=>{const n=await t(e);Caido.graphql.renameReplaySession({id:e,name:n})}))}))}))})();